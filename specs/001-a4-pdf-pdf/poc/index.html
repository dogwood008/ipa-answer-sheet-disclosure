<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PoC: A4 PDF生成（IPA答案用紙）</title>
  <style>
    body{font-family: system-ui, sans-serif; padding:20px}
    label{display:block;margin:8px 0}
    #log{white-space:pre-wrap;border:1px solid #ddd;padding:8px;height:120px;overflow:auto}
  </style>
</head>
  <!-- pdf-lib UMD from CDN (loads global PDFLib) -->
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <!-- fontkit UMD for embedding custom TTF/OTF with pdf-lib -->
  <script src="https://unpkg.com/@pdf-lib/fontkit/dist/fontkit.umd.min.js"></script>
  <!-- PDF.js (Global build) for rasterizing locked/complex PDFs purely client-side -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    // Configure PDF.js worker
    if (window['pdfjsLib']) {
      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js'
    }
  </script>
</head>
</head>
<body>
  <h1>PoC: A4 PDF生成（IPA答案用紙）</h1>
  <p>テンプレートは実行時にIPAの公開URLから取得します。フォントはNoto Sansを試みます。簡易デモです。</p>

  <label>ふりがな <input id="furigana" value="やまだ たろう" aria-label="ふりがな"></label>
  <label>氏名 <input id="name" value="山田 太郎"></label>
  <label>受験番号 <input id="examNumber" value="12345678"></label>

  <div id="circleOptions" style="margin:8px 0;">
    <span style="margin-right:8px;">円の描画:</span>
    <label style="margin-right:8px;"><input type="radio" name="drawCircle" id="drawCircleOn" value="draw"> 描く</label>
    <label><input type="radio" name="drawCircle" id="drawCircleOff" value="nodraw" checked> 描かない</label>
  </div>

  <div id="rectOptions" style="margin:8px 0;">
    <span style="margin-right:8px;">矩形の描画:</span>
    <label style="margin-right:8px;"><input type="checkbox" id="drawRect"> 描く</label>
    <label style="margin-right:8px;">x: <input id="rectX" type="number" value="50" style="width:80px"></label>
    <label style="margin-right:8px;">y: <input id="rectY" type="number" value="60" style="width:80px"></label>
    <label style="margin-right:8px;">width: <input id="rectW" type="number" value="100" style="width:80px"></label>
    <label>height: <input id="rectH" type="number" value="80" style="width:80px"></label>
  </div>

  <button id="generate">PDF生成・プレビュー</button>
  <a id="download" style="pointer-events:none;opacity:0.5;margin-left:8px;" download>ダウンロード</a>

  <h3>色の選択</h3>
  <div id="colorSection" style="margin:8px 0;">
    <div style="margin-bottom:6px;">
      <strong>プリセット:</strong>
      <button type="button" id="presetBlack" aria-label="黒に設定">黒</button>
      <button type="button" id="presetRed" aria-label="赤に設定">赤</button>
    </div>
    <div style="margin-bottom:6px;">
      <label for="colorPicker"><strong>カラーピッカー:</strong></label>
      <input id="colorPicker" type="color" value="#000000" aria-label="カラーピッカー" />
    </div>
    <div style="margin-bottom:6px;">
      <label for="colorName"><strong>CSS 色名:</strong></label>
      <input id="colorName" type="text" placeholder="例: green" aria-label="CSS 色名入力" />
    </div>
    <div>
      <span>選択中の色プレビュー: </span>
      <span id="colorSwatch" aria-label="選択色プレビュー" title="#000000" style="display:inline-block;width:20px;height:20px;border:1px solid #ccc;background:#000000;vertical-align:middle;"></span>
      <span id="colorValue" style="margin-left:6px;">#000000</span>
    </div>
  </div>

  <h3>テンプレートPDF</h3>
  <p>
    <a id="templateLink" href="https://www.ipa.go.jp/privacy/hjuojm000000f2fl-att/02.pdf" target="_blank" rel="noopener">IPAテンプレートをこのリンクからダウンロード</a>
  </p>
  <label>またはローカルに保存したテンプレートPDFを選択: <input id="templateFile" type="file" accept="application/pdf"></label>
  <label>フォントファイル（日本語対応：.ttf/.otf）を選択: <input id="fontFile" type="file" accept="font/ttf,font/otf,.ttf,.otf"></label>

  <h3>ログ</h3>
  <div id="log"></div>

  <script src="./script.js"></script>
</body>
</html>
